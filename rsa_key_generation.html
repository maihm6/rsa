<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>RSA å¯†é’¥ç”Ÿæˆ + åŠ å¯†è§£å¯†ï¼ˆå¸¦ç‹¬ç«‹å¯†æ–‡è¾“å…¥ï¼‰</title>
  <script src="https://cdn.jsdelivr.net/npm/jsencrypt@3.0.0/bin/jsencrypt.min.js"></script>
  <style>
    body { max-width: 700px; margin: 40px auto; font-family: Arial, sans-serif; }
    textarea { width: 100%; height: 80px; margin-bottom: 10px; font-family: monospace; }
    button { padding: 8px 16px; margin-bottom: 20px; }
    h2 { margin-top: 30px; }
    .key-block { background: #f9f9f9; padding: 10px; border: 1px solid #ddd; }
  </style>
</head>
<body>

  <h2>ğŸ”‘ ç”Ÿæˆ 1024-bit RSA å¯†é’¥å¯¹</h2>
  <button onclick="generateKeys()">ç”Ÿæˆå¯†é’¥å¯¹</button>
  <div class="key-block">
    <strong>å…¬é’¥ï¼ˆPublic Keyï¼‰:</strong>
    <textarea id="publicKey" readonly placeholder="ç‚¹å‡»ç”Ÿæˆåæ˜¾ç¤ºå…¬é’¥"></textarea>
    <strong>ç§é’¥ï¼ˆPrivate Keyï¼‰:</strong>
    <textarea id="privateKey" readonly placeholder="ç‚¹å‡»ç”Ÿæˆåæ˜¾ç¤ºç§é’¥"></textarea>
  </div>

  <h2>ğŸ” æ˜æ–‡è¾“å…¥</h2>
  <textarea id="plainText" placeholder="è¾“å…¥è¦åŠ å¯†çš„å†…å®¹ï¼ˆå¦‚ abc æˆ– ä½ å¥½ï¼‰"></textarea>
  <button onclick="doEncrypt()">åŠ å¯† â†’</button>

  <h2>å¯†æ–‡è¾“å‡ºï¼ˆBase64ï¼‰</h2>
  <textarea id="cipherOutput" placeholder="è¿™é‡Œæ˜¾ç¤ºåŠ å¯†åçš„å¯†æ–‡"></textarea>

  <h2>ğŸ”“ ç‹¬ç«‹å¯†æ–‡è¾“å…¥</h2>
  <textarea id="cipherInput" placeholder="åœ¨æ­¤ç²˜è´´è¦è§£å¯†çš„å¯†æ–‡"></textarea>
  <button onclick="doDecrypt()">â† è§£å¯†</button>

  <h2>è§£å¯†è¾“å‡ºï¼ˆæ˜æ–‡ï¼‰</h2>
  <textarea id="decryptedText" placeholder="è¿™é‡Œæ˜¾ç¤ºè§£å¯†åçš„æ˜æ–‡"></textarea>

<script>
  let encryptor, publicKeyPEM, privateKeyPEM;

  function generateKeys() {
    encryptor = new JSEncrypt({ default_key_size: 1024 });
    encryptor.getKey();
    publicKeyPEM = encryptor.getPublicKey();
    privateKeyPEM = encryptor.getPrivateKey();

    document.getElementById('publicKey').value = publicKeyPEM;
    document.getElementById('privateKey').value = privateKeyPEM;
    document.getElementById('cipherOutput').value = '';
    document.getElementById('cipherInput').value = '';
    document.getElementById('decryptedText').value = '';
  }

  function doEncrypt() {
    if (!encryptor) {
      alert('è¯·å…ˆç‚¹å‡»â€œç”Ÿæˆå¯†é’¥å¯¹â€');
      return;
    }
    const plain = document.getElementById('plainText').value;
    if (!plain) {
      alert('è¯·è¾“å…¥æ˜æ–‡');
      return;
    }
    const cipher = encryptor.encrypt(plain);
    if (!cipher) {
      alert('åŠ å¯†å¤±è´¥ï¼šæ–‡æœ¬è¿‡é•¿æˆ–å¯†é’¥é”™è¯¯');
      return;
    }
    document.getElementById('cipherOutput').value = cipher;
  }

  function doDecrypt() {
    if (!encryptor) {
      alert('è¯·å…ˆç‚¹å‡»â€œç”Ÿæˆå¯†é’¥å¯¹â€');
      return;
    }
    const cipher = document.getElementById('cipherInput').value.trim();
    if (!cipher) {
      alert('è¯·è¾“å…¥è¦è§£å¯†çš„å¯†æ–‡');
      return;
    }
    const decryptor = new JSEncrypt();
    decryptor.setPrivateKey(privateKeyPEM);
    const result = decryptor.decrypt(cipher);
    if (result === false) {
      alert('è§£å¯†å¤±è´¥ï¼šå¯†æ–‡æˆ–ç§é’¥æœ‰è¯¯');
      return;
    }
    document.getElementById('decryptedText').value = result;
  }
</script>

</body>
</html>
